<style>
    /*
        dark background = #005a9e
        light background = #ececec
        light border = #3cabff
        light text = #ececec
        dark text = #333
        --csp-list-medium:;
        --csp-list-light:;
        --csp-list-urgent:;
        --csp-list-x: maroon;
    */
    #csp_list_header {
        padding: 10px;
    }

    #csp_list_SearchBox {
        width: 70%;
    }

    /* Style buttons */
    #csp_list_filter_buttons {
        padding: 10px;
        color: #333;
    }

    #csp_list_filter_buttons .csp_list_btn {
        border: 2px solid #bcbcbc;
        background-color: #bcbcbc;
        color: #333;
        cursor: pointer;
        border-radius: 5px;
        min-width: auto;
        margin-left: 0;
        margin-right: 5px;
        position: relative;
        padding-left: 40px;
        height: 45px;
        width: 135px;
    }

    #csp_list_filter_buttons .csp_list_filter {
        border: 2px solid #3cabff;
        background-color: #3cabff;
        color: #333;
        cursor: pointer;
    }

    #csp_list_filter_buttons::after {
        content: " ";
        clear: both;
        display: table;
    }

    .csp_list_card {
        box-shadow: 0 4px 8px 0 rgba(0, 0, 0, 0.2);
        margin: 5px;
        background: #ececec;
        width: 300px;
        height: 185px;
        float: left;
    }

    .csp_list_card:hover {
        box-shadow: 11px 12px 14px -8px #333;
        transition: .5s;
    }

    .csp_list_url,
    .csp_list_url:visited {
        color: #333;
        transition: .5s;
        display: block;
        height: calc(100% - 10px);
    }

    .csp_list_url:hover {
        text-decoration: none;
        transition: .5s;
    }

    .csp_list_cardTitle {
        background: #005a9e;
        color: #fff;
        font-size: 14px;
        text-align: center;
        font-weight: 600;
        height: 45px;
        line-height: 45px;
        position: relative;
    }

    #csp_list_filter_buttons .csp_list_btn .csp_list_icon {
        position: absolute;
        left: 0px;
        top: 0px;
        padding: 15px;
        height: 16px;
        width: 16px;
    }

    .csp_list_icon {
        position: absolute;
        left: 0px;
        top: 0px;
        padding: 15px;
        height: 16px;
        width: 16px;
    }

    #test {
        background-color: firebrick;
    }

    #test .csp_list_icon {
        position: relative;
        display: inline-block;
        margin: 5px;
    }

    .csp_list_icon_100 {
        background: url('/_layouts/15/images/ltgen.png?rev=40') no-repeat center /50px;
    }

    .csp_list_icon_101 {
        background: url('/_layouts/15/images/ltdl.png?rev=40') no-repeat center /50px;
    }

    .csp_list_icon_102 {
        background: url('/_layouts/15/images/ltsurvey.png?rev=40') no-repeat center /50px;
    }

    .csp_list_icon_103 {
        background: url('/_layouts/15/images/ltlink.png?rev=40') no-repeat center /50px;
    }

    .csp_list_icon_104 {
        background: url('/_layouts/15/images/ltann.png?rev=40') no-repeat center /50px;
    }

    .csp_list_icon_105 {
        background: url('/_layouts/15/images/ltcontct.png?rev=40') no-repeat center /50px;
    }

    .csp_list_icon_106 {
        background: url('/_layouts/15/images/ltevent.png?rev=40') no-repeat center /50px;
    }

    .csp_list_icon_107 {
        background: url('/_layouts/15/images/lttask.png?rev=40') no-repeat center /50px;
    }

    .csp_list_icon_108 {
        background: url('/_layouts/15/images/ltdisc.png?rev=40') no-repeat center /50px;
    }

    .csp_list_icon_109 {
        background: url('/_layouts/15/images/ltil.png?rev=40') no-repeat center /50px;
    }

    .csp_list_cardDescription {
        height: calc(185px - 45px - 10px - 28px);
        padding: 5px;
        overflow: auto;
    }

    .csp_list_cardFooter {
        font-size: 10px;
        height: 18px;
        padding: 5px;
        background: #bcbcbc;
    }

    .csp_list_itemCount {
        display: block;
        text-align: left;
        padding: 1px 5px;
        margin-bottom: 1px;
        float: left;
    }

    .csp_list_lastModified {
        display: block;
        text-align: right;
        padding: 1px 5px;
        margin-bottom: 1px;
        float: right;
    }

    #csp_list_Container .csp_list_filter {
        display: none;
    }

    .csp_list_180days,
    .csp_list_365days {
        background: #ececec;
        color: #333;
        position: relative;
        display: inline-block;
        border-bottom: 1px dotted #333;

    }

    .csp_list_180days:hover .tooltiptext,
    .csp_list_365days:hover .tooltiptext {
        visibility: visible;
    }

    .csp_list_180days {
        background: #ececec;
        color: #333;
    }

    .csp_list_365days {
        background: #f78888;
        color: #333;
    }

    .csp_list_cardFooter .tooltiptext {
        visibility: hidden;
        width: 120px;
        background-color: #333;
        color: #ececec;
        text-align: center;
        border-radius: 6px;
        padding: 5px 0;
        position: absolute;
        z-index: 1;
        bottom: 150%;
        left: 50%;
        margin-left: -60px;
    }

    .csp_list_cardFooter .tooltiptext::after {
        content: " ";
        position: absolute;
        top: 100%;
        /* At the bottom of the tooltip */
        left: 50%;
        margin-left: -5px;
        border-width: 5px;
        border-style: solid;
        border-color: black transparent transparent transparent;
    }

    .csp_list_hilite {
        background-color: #f3d250;
        color: #333;
    }
</style>

<div id="csp_list_header">
    <input id="csp_list_SearchBox" type="search" placeholder="start typing here to filter by title or description"
        onkeyup="csp_list_hilite()">

    <div id="csp_list_filter_buttons">
        <p>toggle a button to filter by type</p>
        <button type="button" class="csp_list_btn csp_list_btn-clear csp_list_filter" id="csp_list_button_filter_clear"
            onclick="cspClearFilter(this)" data-template-type="clear">
            <div class="csp_list_icon csp_list_icon_clear"></div>Show
            All
        </button>
        <button type="button" class="csp_list_btn csp_list_btn-filter" id="csp_list_button_filter_100"
            onclick="cspToggleFilter(this)" data-template-type="100">
            <div class="csp_list_icon csp_list_icon_100"></div>Custom
            list
        </button>
        <button type="button" class="csp_list_btn csp_list_btn-filter" id="csp_list_button_filter_101"
            onclick="cspToggleFilter(this)" data-template-type="101">
            <div class="csp_list_icon csp_list_icon_101"></div>Document
            library
        </button>
        <button type="button" class="csp_list_btn csp_list_btn-filter" id="csp_list_button_filter_102"
            onclick="cspToggleFilter(this)" data-template-type="102">
            <div class="csp_list_icon csp_list_icon_102"></div>Survey
        </button>
        <button type="button" class="csp_list_btn csp_list_btn-filter" id="csp_list_button_filter_103"
            onclick="cspToggleFilter(this)" data-template-type="103">
            <div class="csp_list_icon csp_list_icon_103"></div>Links
        </button>
        <button type="button" class="csp_list_btn csp_list_btn-filter" id="csp_list_button_filter_104"
            onclick="cspToggleFilter(this)" data-template-type="104">
            <div class="csp_list_icon csp_list_icon_104"></div>Announcements
        </button>
        <button type="button" class="csp_list_btn csp_list_btn-filter" id="csp_list_button_filter_105"
            onclick="cspToggleFilter(this)" data-template-type="105">
            <div class="csp_list_icon csp_list_icon_105"></div>Contacts
        </button>
        <button type="button" class="csp_list_btn csp_list_btn-filter" id="csp_list_button_filter_106"
            onclick="cspToggleFilter(this)" data-template-type="106">
            <div class="csp_list_icon csp_list_icon_106"></div>Calendar
        </button>
        <button type="button" class="csp_list_btn csp_list_btn-filter" id="csp_list_button_filter_107"
            onclick="cspToggleFilter(this)" data-template-type="107">
            <div class="csp_list_icon csp_list_icon_107"></div>Tasks
        </button>
        <button type="button" class="csp_list_btn csp_list_btn-filter" id="csp_list_button_filter_108"
            onclick="cspToggleFilter(this)" data-template-type="108">
            <div class="csp_list_icon csp_list_icon_108"></div>Discussion board
        </button>
        <button type="button" class="csp_list_btn csp_list_btn-filter" id="csp_list_button_filter_109"
            onclick="cspToggleFilter(this)" data-template-type="109">
            <div class="csp_list_icon csp_list_icon_109"></div>Picture
            Library
        </button>
    </div>
</div>

<div id="csp_list_Container"></div>

<script>
    var sourceData;
    //Reset filter on clear(x) click
    $("#csp_list_SearchBox").on("input", function () {
        document.getElementById("csp_list_Container").innerHTML = sourceData;
    });

    function getListInfo() {
        var AllowedTemplates = [100, 101, 102, 103, 104, 105, 106, 107, 108, 109];
        var defer = $.Deferred();

        var request = $.ajax({
            type: "GET",
            url: _spPageContextInfo.siteAbsoluteUrl + "/_api/Web/Lists" +
                "?$expand=RootFolder",
            beforeSend: function (xhr) {
                xhr.setRequestHeader('Accept', 'application/json;odata=verbose');
            },
            success: function (result) {
                var lists = result.d.results;

                lists.sort(function (a, b) {
                    var x = a.Title.toLowerCase();
                    var y = b.Title.toLowerCase();

                    if (x < y) { return -1; }
                    if (x > y) { return 1; }
                    return 0;
                });

                var listHTML = "<div id='csp_list_cardlist'>";
                var liHTML;
                var aHTML;
                var urlHTML;
                var titleHTML;
                var descriptionHTML;
                var footerHTML;
                var listAge;

                for (i = 0; i < lists.length; i++) {
                    if (lists[i].Hidden == false) {
                        var oldContent = "";

                        if (moment().diff(moment(lists[i].LastItemModifiedDate), 'days') > 365) {
                            oldContent = " csp_list_365days"
                        } else if (moment().diff(moment(lists[i].LastItemModifiedDate), 'days') > 180) {
                            oldContent = " csp_list_180days"
                        }
                        if (AllowedTemplates.indexOf(lists[i].BaseTemplate) > -1) {
                            liHTML = "<div class='csp_list_card csp_list_template_" + lists[i].BaseTemplate +
                                "' data-template-type='" + lists[i].BaseTemplate + "'>";
                            aHTML = "<a class='csp_list_url' href='" + lists[i].RootFolder.ServerRelativeUrl + "'>";
                            titleHTML = "<div class='csp_list_cardTitle'>" + lists[i].Title +
                                "<div class=\"csp_list_icon csp_list_icon_" + lists[i].BaseTemplate + "\"></div>" +
                                "</div>";
                            descriptionHTML = "<div class='csp_list_cardDescription'>" + lists[i].Description + "</div>";
                            footerHTML = "<div class='csp_list_cardFooter'><div class='csp_list_itemCount'>" + lists[i].ItemCount +
                                (lists[i].ItemCount > 1 ? " items" : " item") +
                                "</div>" +
                                "<div class='csp_list_lastModified" + oldContent + "'>Last Modified " +
                                moment(moment(lists[i].LastItemModifiedDate)).fromNow() +
                                "<span class='tooltiptext'>This content has not been changed in a long time.  Consider archiving it.</span>" +
                                "</div></div>";

                            listHTML += liHTML + aHTML + titleHTML + descriptionHTML + footerHTML + "</a></div>";
                        }
                    }
                }

                listHTML += "</div>";

                defer.resolve(listHTML);
            },
            error: function (result) {
                defer.reject();
                console.log("Error");
            }
        });

        return defer.promise();
    }

    var sites = getListInfo();

    $.when(sites).then(function (data) {
        sourceData = data;
        document.getElementById("csp_list_Container").innerHTML = sourceData;
    });

    function csp_list_hilite() {
        var searchterm = document.getElementById("csp_list_SearchBox").value;
        var searchexp = new RegExp(searchterm, "ig");

        if (searchterm.length > 0) {
            $(".csp_list_cardDescription").each(function (index, value) {

                var txt = $(this).text();
                var html = txt.replace(searchexp, "<span class='csp_list_hilite'>" + searchterm + "</span>")
                $(this).html(html);
            });
            $(".csp_list_cardTitle").each(function (index, value) {

                var txt = $(this).text();
                var html = txt.replace(searchexp, "<span class='csp_list_hilite'>" + searchterm + "</span>")
                $(this).html(html);
            });
        }
        else {
            document.getElementById("csp_list_Container").innerHTML = sourceData;
            document.getElementById("csp_list_SearchBox").blur();
            document.getElementById("csp_list_SearchBox").focus();
        }

        $(".csp_list_card").each(function (index, value) {
            var str = $(this).find(".csp_list_hilite").text();
            if (str.length == 0) {
                $(this).addClass("ms-hidden");
            }
        });
    }

    function cspToggleFilter(obj) {
        obj.classList.toggle("csp_list_filter");
        setFilter();
    }

    function cspClearFilter(obj) {
        var buttons = document.getElementsByClassName("csp_list_btn-filter");

        for (i = 0; i < buttons.length; i++) {
            buttons[i].classList.remove("csp_list_filter");
        }

        setFilter();
    }

    function setFilter() {
        var buttons = document.getElementsByClassName("csp_list_btn-filter csp_list_filter");
        var items = document.getElementsByClassName("csp_list_card");

        if (buttons.length === 0) {
            document.getElementById("csp_list_button_filter_clear").classList.add("csp_list_filter");

            for (i = 0; i < items.length; i++) {
                items[i].classList.remove("csp_list_filter");
            }
        } else {
            document.getElementById("csp_list_button_filter_clear").classList.remove("csp_list_filter");

            for (i = 0; i < items.length; i++) {
                items[i].classList.add("csp_list_filter");
            }

            for (i = 0; i < buttons.length; i++) {
                for (j = 0; j < items.length; j++) {
                    if (buttons[i].getAttribute("data-template-type") === items[j].getAttribute("data-template-type")) {
                        items[j].classList.remove("csp_list_filter");
                    }
                }
            }

        }
    }
</script>